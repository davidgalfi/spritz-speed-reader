*{margin:0;padding:0;box-sizing:border-box}

:root{
  /* Dark Mode (Default) */
  --bg:#222;
  --panel:#2b2b2b;
  --text:#ddd;
  --muted:#a9a9a9;
  --accent:#ff3b30;
  --border:#555;
  --btn1:#333;
  --btn2:#444;
  --rewind-bg-start:#2a5fb8;
  --rewind-bg-end:#3478f6;
  --danger-bg-start:#4a1c1a;
  --danger-bg-end:#5a2422;
  --input-bg: linear-gradient(to bottom, var(--btn1), var(--btn2));
  --spritz-lines: #ddd;
}

/* Light Mode Override */
body.light-mode {
  --bg: #f5f5f7;
  --panel: #ffffff;
  --text: #1d1d1f;
  --muted: #86868b;
  --accent: #ff3b30; /* Keep red consistent for pivot */
  --border: #d2d2d7;
  --btn1: #e8e8ed;
  --btn2: #d2d2d7;
  --rewind-bg-start: #0071e3;
  --rewind-bg-end: #0077ed;
  --danger-bg-start: #ff453a;
  --danger-bg-end: #ff3b30; /* Actually lighter red for light mode */
  --input-bg: #ffffff;
  --spritz-lines: #1d1d1f;
}

html{font-size:10px}

body{
  background:var(--bg);
  color:var(--text);
  font-family:'Open Sans','Segoe UI',Arial,sans-serif;
  font-size:1.4rem;
  min-height:100vh;
  touch-action: pan-y;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Theme Toggle Button */
.theme-toggle {
  position: fixed;
  top: max(1rem, env(safe-area-inset-top));
  right: max(1rem, env(safe-area-inset-right));
  background: none;
  border: none;
  font-size: 2.4rem;
  cursor: pointer;
  z-index: 1000;
  padding: 0.5rem;
  border-radius: 50%;
  transition: transform 0.2s;
}

.theme-toggle:hover {
  transform: scale(1.1);
  background-color: rgba(128, 128, 128, 0.1);
}

.app{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  padding: max(2rem, env(safe-area-inset-top)) 1.6rem max(2rem, env(safe-area-inset-bottom));
  gap:2.4rem;
}

.spritz{
  position:relative;
  width:min(92vw, 36rem);
  padding:1rem 0 1.2rem;
  border-top:2px solid var(--spritz-lines);
  border-bottom:2px solid var(--spritz-lines);
  touch-action: pan-x;
  user-select: none;
}

.spritz:before,.spritz:after{
  content:'';
  position:absolute;
  left:40%;
  height:.8rem;
  width:2px;
  margin-left:-1px;
  background-color:var(--spritz-lines);
}
.spritz:before{top:0}
.spritz:after{bottom:0}

.spritz-word{
  font-size:clamp(2.2rem, 5.5vw, 3rem);
  line-height:clamp(3rem, 7vw, 3.6rem);
  height:clamp(3rem, 7vw, 3.6rem);
  font-weight:650;
}

.spritz-word div{display:table-cell;color:var(--text)}
.spritz-word div:first-child{width:40%;text-align:right}
.spritz-word div:nth-child(2){color:var(--accent)}
.spritz-word div:last-child{width:60%;text-align:left}

.settings{
  width:min(92vw, 36rem);
  display:flex;
  flex-direction:column;
  gap:1.2rem;
}

.field{display:flex;flex-direction:column;gap:.6rem}
.label{color:var(--muted);font-size:1.2rem;letter-spacing:.02em}

.speed,
.demo-text{
  width:100%;
  color:var(--text);
  border:1px solid transparent;
  border-radius:1rem;
  background: var(--input-bg);
  padding:1.2rem 1.4rem;
  outline:none;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1); /* Subtle shadow for depth */
}

/* Specific styling for light mode inputs to look nice */
body.light-mode .speed, 
body.light-mode .demo-text {
  border: 1px solid var(--border);
}


.speed{height:4.4rem;text-align:center;font-weight:700}
.demo-text{min-height:10em;max-height:40vh;resize:vertical;line-height:1.4}

.speed:focus,
.demo-text:focus{border-color:var(--border)}

.primary,
.control-btn{
  width:100%;
  border:0;
  border-radius:1rem;
  color: #fff; /* Always white text on buttons usually looks better, or var(--text) if buttons change bg */
  background:linear-gradient(to bottom, var(--btn1), var(--btn2));
  padding:1.2rem 1.6rem;
  cursor:pointer;
  font-size:1.5rem;
  font-weight:650;
  color: var(--text); /* Use theme text color for main buttons */
}
/* Override text color for primary/control buttons in light mode if needed */
body.light-mode .primary,
body.light-mode .control-btn {
   color: var(--text);
   background: var(--btn1); /* Solid color or gradient */
   border: 1px solid var(--border);
}


.primary:active,
.control-btn:active{transform:translateY(1px)}

.reading-controls{
  width:min(92vw, 36rem);
  display:grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap:1rem;
}

.control-btn.rewind{
  background:linear-gradient(to bottom, var(--rewind-bg-start), var(--rewind-bg-end));
  font-size:1.4rem;
  color: white; /* Rewind always white text on blue */
  border: none;
}

.control-btn.danger{
  background:linear-gradient(to bottom, var(--danger-bg-start), var(--danger-bg-end));
  color: white; /* Stop always white text on red */
  border: none;
}

body.reading-mode .settings{display:none}
body.reading-mode .reading-controls{display:grid}
/* Hide theme toggle during reading to minimize distraction */
body.reading-mode .theme-toggle{display:none}


.advanced-settings{
  background:var(--panel);
  border-radius:1rem;
  padding:1rem;
  margin:.6rem 0;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.advanced-settings summary{
  cursor:pointer;
  font-weight:600;
  font-size:1.3rem;
  color:var(--muted);
  padding:.6rem;
  user-select:none;
}

.advanced-settings summary:hover{color:var(--text)}

.advanced-content{
  margin-top:1rem;
  display:flex;
  flex-direction:column;
  gap:.8rem;
}

.field-inline{
  display:flex;
  align-items:center;
  gap:.8rem;
  font-size:1.3rem;
}

.field-inline input[type="checkbox"]{
  width:1.8rem;
  height:1.8rem;
  cursor:pointer;
  accent-color:var(--accent);
}

.field-inline .small-input{
  width:6rem;
  height:3.2rem;
  text-align:center;
  border-radius:.6rem;
  background: var(--input-bg);
  border:1px solid var(--border);
  color:var(--text);
  padding:.4rem;
}

@media (max-width: 380px){
  .reading-controls{grid-template-columns: 1fr; gap:1rem}
}

@media (max-height: 520px){
  .app{gap:1.6rem; justify-content:flex-start; padding-top:max(1.6rem, env(safe-area-inset-top))}
  .demo-text{max-height:28vh}
}
